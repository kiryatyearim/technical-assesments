package com.kiryatyearim.technical.assesment.questions;

import java.util.*;
import java.util.stream.Collectors;

public class GiftingGroupsQuestion {
    public static void main(String[] args) {

        List<String> inputList = Arrays.asList(
                "1000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000",
                "0100000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000",
                "0010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0000001000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0000000100000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000",
                "0000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0000000001000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000",
                "0000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0000000000001000000000001000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0000000000000010000000000100000000000000000000000000000000000000000000000000000000100000000000000000",
                "0000000000000001000000000000000000000000000000000000000000000000000000001000000000000000000000000000",
                "0000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000100000000",
                "0000000000000000001000000000000000000000000010000000000000000000000000000000000000000000000000000000",
                "0000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0000000000000000000010000000000000000000000000000000000000000000000000000000000000000000100000000000",
                "0000001000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0000000000000000000000010000000000000000000000000000000100000000000000000000000000000000000000000000",
                "0000000000001000000000001000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0000000000000010000000000100000000000000000000000000000000000010000000000000000000000000000000000000",
                "0000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000",
                "0000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000",
                "0000000100000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000",
                "0000000000000000000000000000010000000000000000000000100000000000000000000000000000000000000000000000",
                "0000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000",
                "0000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000",
                "0000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000",
                "0000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000",
                "0000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000",
                "0000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000",
                "0000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000",
                "0000000000000000000000000000000000000100000000000000000100000000000000000000000000000000000000000000",
                "0000000000000000000000000000000000000010001000000000000000000000000000000000000000000000000000000000",
                "1000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000",
                "0000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000",
                "0000000000000000000000000000000000000000010000010000000000000000000000000000000000000000000000000000",
                "0000000000000000000000000000000000000010001000000000000000000000000000000000000000000000000000000000",
                "0000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000",
                "0000000000000000001000000000000000000000000010000000100000000000000000000000000000000000000000000000",
                "0000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000",
                "0000000000000000000000000000000000000000000000100000000000000000000000000001000000000000000100000000",
                "0000000000000000000000000000000000000000010000010000010000000000000000000000000000000100000000000000",
                "0100000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000",
                "0000000001000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000001000000000000001000000000000000000000000000000000",
                "0000000000000000000000000000010000000000000010000000100000000000000000000000000000000000000000000010",
                "0000000000000000000000000000000000000000000000010000010000000000000000000000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000",
                "0000000000000000000000010000000000000100000000000000000100000000000000000000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000001010000000000000000000000000000000000000001",
                "0000000000000000000000000000000000000000000000000000000000100000000100000000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000001010000000000000000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000100000000000100000000000000000000000000",
                "0000000000000000000000000100000000000000000000000000000000000010000000100000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000001000000000000001000000000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000100000000100000000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000010000000100000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000",
                "0000000000000001000000000000000000000000000000000000000000000000000000001000000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000100000000000100000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000",
                "0000000000000000000000000000000000000000000000100000000000000000000000000001000000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000",
                "0000000000000010000000000000000000000000000000000000000000000000000000000000000000100000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000",
                "0000000000000000000000000000000000000000000000010000000000000000000000000000000000000100000000000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000",
                "0000000000000000000010000000000000000000000000000000000000000000000000000000000000000000100000000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000",
                "0000000000000000010000000000000000000000000000100000000000000000000000000000000000000000000100000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000",
                "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100",
                "0000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000010",
                "0000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000001"
        );
        int result = countGroups(inputList);
        System.out.println(result);
    }

    private static int countGroups(List<String> related) {
        int[][] relations = new int[related.size()][related.size()];
        int[] groupHead = new int[related.size()];

        for (int i=0; i < related.size(); i++) {
            char[] row = related.get(i).toCharArray();
            for (int j=0; j<row.length; j++) {
                if (row[j] == '1') {
                    relations[i][j]=1;
                } else {
                    relations[i][j]=0;
                }
            }
            groupHead[i] = i;
        }
        //System.out.println("groupHead: " + Arrays.toString(groupHead));

        for (int i=0; i < relations.length; i++) {
            for (int j=0; j<relations[i].length; j++) {
                if (relations[i][j] != relations[j][i]) {
                    System.out.println("***INCONSISTENCY");
                }

                if (i==44 && j==52) {
                    System.out.println("relations[i][j]: " + relations[i][j]);
                }

                if (relations[i][j] == 1) {
                    if (groupHead[i] != i) {

                        groupHead[groupHead[j]] = groupHead[i];
                        groupHead[j] = groupHead[i];


                    } else if (groupHead[j] == j) {
                        groupHead[j] = groupHead[i];
                    }
                }
            }
        }
        System.out.println("groupHead: " + Arrays.toString(groupHead));
        List<Integer> l = Arrays.stream(groupHead).boxed().collect(Collectors.toList());
        Set<Integer> uniqueHeads = new HashSet<>(l);
        System.out.println("Unique groupHead: " + uniqueHeads);
        return uniqueHeads.size();

    }

}
